---
title: "The Global Unicorn Landscape"
subtitle: "Funding, Valuation, and Growth Dynamics of Billion-Dollar Startups"
author: "Himangshu Chetia"
format:
  html:
    toc: true
    toc-location: left
    toc-depth: 3
    code-tools: true
    code-fold: true
---

## The Business Problem
A Venture Capital (VC) firm wants to identify "efficient" unicorns (reaching $1B in <5 years) outside Silicon Valley to find underserved, high-growth markets.

### Key Performance Indicators (KPIs)
1. **Speed to Unicorn:** Years from foundation to $1B+
2. **Capital Efficiency Ratio:** Valuation $\div$ Total Funding.
3. **Elite Investors:** Investors with stakes in the top 10% most efficient startups.
4. **Market Saturation:** Density of unicorns per city/industry.

## Data Preprocessing
* **Currency Normalization:** Converted mixed-string funding `($B/$M)` into integers for calculation.
* **Investor Parsing:** Created a "long" version of the data (where one company has multiple rows, one for each investor) using R & the `tidyverse()` package.
* **Spatial Correction:** Imputed missing city data for Singapore, Hong Kong and Bahamas entities.
* **Outlier Handling:** Addressed data entry errors (e.g., founded dates listed after join dates).

# Phase 1: Data Engineering & Pre-processing (Excel/R)

*Goal: Perform heavy-duty aggregation and multi-dimensional filtering.*

## Currency Normalization

Used the following Excel formula to convert shorthand ($8B, $200M) into long-form integers:

```excel
=IF(RIGHT(B2,1)="B", 
    SUBSTITUTE(SUBSTITUTE(B2,"$",""),"B","")*1000000000, 
    IF(RIGHT(B2,1)="M", 
        SUBSTITUTE(SUBSTITUTE(B2,"$",""),"M","")*1000000, 
        SUBSTITUTE(B2,"$","")*1
    )
)
```

## Date Standardization

* Converted all dates into the `YYYY-MM-DD` format

* Identified and fixed outliers in the date columns where `Year Founded` > `Date Joined` using the `DATEDIF` function.

* Imputed missing values (like the Singapore,Hong Kong and Bahamas city gap).

## Data Transformation

### Wide to Long Format

Created a dataset (dataset_long.csv)containing only company and investor columns by converting the wide data into long format using the following R script:

```r
# Load the necessary libraries
library(tidyverse)

# Read the data
df <- read_csv("dataset_long_temp.csv")

# Convert from wide to long
df_long <- df %>%
separate_rows(investors, sep = ",") %>%
mutate(investors = str_trim(investors))

# View result
view(df_long)

# Save the file
readr::write_csv(df_long, "dataset_long.csv")
```
### Geocoding

Created a dataset (geocoded_unicorns.csv) cntaining the Latitude and Longitude of the cities.

# Phase 2: Database Management & SQL Analysis

*Goal: Establish the baseline metrics.*

## The "Efficiency" Query:

Performed the following SQL query to filter the companies that reached Unicorn status within 5 years:

```sql
SELECT
    company,
    industry,
    country,
    DATEDIFF(date_joined, year_founded)/365 AS exact_years_to_unicorn
FROM dataset
WHERE DATEDIFF(date_joined, year_founded)/365 <= 5
ORDER BY exact_years_to_unicorn ASC;
```

| # | company | industry | country | exact_years_to_unicorn |
|---|---------|----------|---------|------------------------|
| 1 | Ola Electric Mobility | Auto & transportation | India | 0.4986 |
| 2 | Playco | Other | Japan | 0.7233 |
| 3 | candy.com | Fintech | United States | 0.8027 |
| 4 | ClickHouse | Data management & analytics | United States | 0.8219 |
| 5 | Mensa Brands | Other | India | 0.8740 |
| 6 | Flink Food | E-commerce & direct-to-consumer | Germany | 0.9151 |
| 7 | Jokr | E-commerce & direct-to-consumer | United States | 0.9178 |
| 8 | Avant | Artificial intelligence | United States | 0.9616 |
| 9 | GlobalBees | E-commerce & direct-to-consumer | India | 0.9890 |
| 10 | EQRx | Health | United States | 1.0301 |
| 11 | Apus Group | Mobile & telecommunications | China | 1.0411 |
| 12 | Clubhouse | Mobile & telecommunications | United States | 1.0658 |
| ... | ... | ... | ... | ... |

## Geographic Grouping:

Performed the following query to find the `Average Valuation` per startup per country:

```sql
SELECT
	country,
    avg(valuation) AS average_valuation
FROM dataset
GROUP BY country
ORDER BY average_valuation DESC;
```

| # | country | average_valuation |
|---|---------|------------------|
| 1 | Bahamas | 3200000000 |
| 2 | Sweden | 1050000170.660666 |
| 3 | Australia | 7000000000 |
| 4 | Estonia | 650000256 |
| 5 | Turkey | 5333333333.333333 |
| 6 | Lithuania | 5000000000 |
| 7 | Indonesia | 4666666666.666667 |
| 8 | United Kingdom | 4534883732.83721 |
| 9 | China | 4023121369.5260115 |
| 10 | Denmark | 3500000000 |
| 11 | Austria | 3500000000 |
| 12 | United States | 3439501772.9822063 |
| ... | ... | ... |

## Investor Counting:

Wrote the following query to identify which specific investors appear most frequently in the "Top 10%" of the most efficient startups:

```sql
WITH enriched AS (
    SELECT
        company,
        investors,
        YEAR(date_joined) - YEAR(year_founded) AS years_to_unicorn
    FROM dataset_long
    WHERE YEAR(date_joined) - YEAR(year_founded) <= 5
),
ranked AS (
    SELECT
        company,
        investors,
        years_to_unicorn,
        NTILE(10) OVER (ORDER BY years_to_unicorn) AS decile
    FROM enriched
)

SELECT
    investors,
    COUNT(*) AS companies_invested
FROM ranked
WHERE decile = 1
GROUP BY investors
ORDER BY companies_invested DESC;
```

| # | investors | companies_invested |
|---|-----------|------------------|
| 1 | Andreessen Horowitz | 7 |
| 2 | Tiger Global Management | 5 |
| 3 | DST Global | 4 |
| 4 | Accel | 4 |
| 5 | Index Ventures | 3 |
| 6 | Thrive Capital | 3 |
| 7 | Sequoia Capital | 3 |
| 8 | SoftBank Group | 3 |
| 9 | Insight Partners | 3 |
| 10 | Benchmark | 2 |
| 11 | General Catalyst | 2 |
| 12 | Khosla Ventures | 2 |
| ... | ... | ... |

## Top valued industries:

Identified industries with the highest company valuations.

```sql
SELECT
    industry,
    SUM(valuation) AS total_valuation
FROM dataset
GROUP BY industry;
```

| # | industry | total_valuation |
|---|----------|-----------------|
| 1 | Artificial intelligence | 376999997440 |
| 2 | Other | 251999997952 |
| 3 | E-commerce & direct-to-consumer | 425999997952 |
| 4 | Fintech | 882000002048 |
| 5 | Internet software & services | 594999998464 |
| 6 | Supply chain, logistics, & delivery | 176999998976 |
| 7 | Consumer & retail | 106000002048 |
| 8 | Data management & analytics | 136000001536 |
| 9 | Edtech | 100000000512 |
| 10 | Health | 197999999488 |
| 11 | Hardware | 990000000512 |
| 12 | Auto & transportation | 990000000512 |
| 13 | Travel | 459999999488 |
| 14 | Cybersecurity | 128999998976 |
| 15 | Mobile & telecommunications | 885999994489 |

# Phase 3: Statistical Discovery & Advanced EDA (R)

*Goal: Use R to uncover statistical relationships, validate assumptions, and extract non-obvious structure from the global unicorn dataset through rigorous exploratory and inferential analysis.*


## Preparation

Load the necessary libraries, a function to format large numbers, set the working directory, load the datasets,calculate time to unicorn status and check the quality of the data.

```{r setup, message = FALSE}
library(tidyverse)
library(scales)
library(knitr)
library(viridis)
library(maps)
library(treemapify)
library(ggraph)
library(igraph)
library(networkD3)

# Custom formatter for large numbers (B for billions, M for millions, K for thousands)
dollar_format_big <- function(x) {
    abs_x <- abs(x)
    case_when(
        abs_x >= 1e9 ~ paste0(sign(x), round(abs_x / 1e9, 1), "B"),
        abs_x >= 1e6 ~ paste0(sign(x), round(abs_x / 1e6, 1), "M"),
        abs_x >= 1e3 ~ paste0(sign(x), round(abs_x / 1e3, 1), "K"),
        TRUE ~ as.character(x)
    )
}

data <- read_csv("dataset.csv") %>%
    mutate(years_to_unicorn = year(date_joined) - year(year_founded))

data_long <- read_csv("dataset_long.csv")

data_geocoded <- read_csv("geocoded_unicorns.csv")

glimpse(data)
glimpse(data_long)
glimpse(data_geocoded)
```

### Data Quality Check

```{r data-quality-summary}
cat("\n=== Missing Data Summary ===")
cat("\nMissing values per column:\n")
print(colSums(is.na(data)))
cat("\nPercentage missing:\n")
print(round(colSums(is.na(data)) / nrow(data) * 100, 2))
cat("\nTotal observations:", nrow(data), "\n")
```

### Efficiency Thresholds

```{r define-thresholds}
# Define valuation thresholds once for consistency
top_10_pct_threshold <- quantile(data$valuation, 0.9, na.rm = TRUE)
cat(
    "\nTop 10% valuation threshold: $",
    dollar_format_big(top_10_pct_threshold),
    "\n",
    sep = ""
)
```

## Time-based Analysis

### Distribution of Years Taken to Reach Unicorn Status

```{r dist-years-to-unicorn, warning = FALSE}
# Calculate dynamic label positions based on actual data
mean_years <- mean(data$years_to_unicorn, na.rm = TRUE)
median_years <- median(data$years_to_unicorn, na.rm = TRUE)
max_years <- max(data$years_to_unicorn, na.rm = TRUE)
data_clean <- data %>% drop_na(years_to_unicorn)
max_density <- max(density(data_clean$years_to_unicorn)$y)

ggplot(data, aes(x = years_to_unicorn, y = after_stat(density))) +
    geom_histogram(fill = "grey70", colour = "white", bins = 50, alpha = 0.8) +
    geom_density(colour = "#404080") +
    geom_vline(
        xintercept = mean_years,
        colour = "#D55E00",
        linetype = "dashed"
    ) +
    geom_vline(
        xintercept = median_years,
        colour = "#0072B2",
        linetype = "dashed"
    ) +
    annotate(
        "text",
        x = mean_years * 1.3,
        y = max_density * 0.85,
        label = "Mean",
        colour = "#D55E00",
        size = 3.5,
        fontface = "bold"
    ) +
    annotate(
        "text",
        x = median_years * 0.7,
        y = max_density * 0.9,
        label = "Median",
        colour = "#0072B2",
        size = 3.5,
        fontface = "bold"
    ) +
    labs(
        title = "Distribution of Years to Reach Unicorn Status",
        subtitle = sprintf(
            "Mean: %.2f, Median: %.2f",
            mean(data$years_to_unicorn),
            median(data$years_to_unicorn)
        ),
        x = "Years to $1B valuation",
        y = "Density"
    ) +
    theme_minimal() +
    xlim(0, 50)
```

### Unicorns Founded Per Year & Joined Per Year

```{r unicorns-founded-joined-per-year}
founded_counts <- data %>%
    mutate(year = year(year_founded)) %>%
    group_by(year) %>%
    summarise(count = n(), .groups = "drop")

joined_counts <- data %>%
    mutate(year = year(date_joined)) %>%
    group_by(year) %>%
    summarise(count = n(), .groups = "drop")

plot_founded <- ggplot(founded_counts, aes(x = year, y = count)) +
    geom_line(linewidth = 1.1, color = "#F8766D") +
    labs(
        title = "Unicorns Founded Per Year",
        x = "Year",
        y = "Number of Unicorns"
    ) +
    theme_minimal(base_size = 13)

plot_joined <- ggplot(joined_counts, aes(x = year, y = count)) +
    geom_line(linewidth = 1.1, color = "#00BFC4") +
    labs(
        title = "Unicorns Joined Per Year",
        x = "Year",
        y = "Number of Unicorns"
    ) +
    theme_minimal(base_size = 13)

plot_founded
plot_joined
```

### Key Findings

* The "Golden Era" (2010–2016): The majority of today's unicorns were founded in this window, with a peak of over 150 companies being founded.

* The 2021 Anomaly: There was a massive, unprecedented spike in companies becoming unicorns in 2021 (>500 companies), likely driven by aggressive venture capital activity post-pandemic.

* Time to Success: It takes an average of 7 years (Mean: 7.01) to reach a $1 billion valuation, though the median is slightly faster at 6 years. Some companies took 25+ years to reach unicorn status, thus pulling the mean towards right.

* The Lag Effect: The sharp drop in "Founding" numbers after 2016 isn't a decline in startups; it simply reflects that companies founded recently haven't had the requisite ~6-7 years growth window to reach unicorn status yet. **Note:** Dataset observations only extend to early 2022, so companies founded after ~2015-2017 appear artificially underrepresented.

* Consistent Correlation: The ~6-year gap between the "Founding Peak" (2015) and the "Unicorn Status Peak" (2021) perfectly aligns with the median growth timeline shown in the distribution chart.

## Capital Efficiency Analysis

*Goal: Evaluate how effectively companies convert venture capital into valuation.*

```{r efficiency-analysis}
# Calculate Efficiency Ratio (Valuation per $1 of Funding)
data <- data %>%
    mutate(efficiency_ratio = valuation / funding)

# Summary statistics for the report
avg_efficiency <- mean(data$efficiency_ratio, na.rm = TRUE)
median_efficiency <- median(data$efficiency_ratio, na.rm = TRUE)

ggplot(data %>% filter(efficiency_ratio < 100), aes(x = efficiency_ratio)) +
    geom_histogram(fill = "#2ecc71", color = "white", bins = 50) +
    geom_vline(
        xintercept = median_efficiency,
        linetype = "dashed",
        color = "red"
    ) +
    annotate(
        "text",
        x = 4,
        y = 70,
        label = "Median",
        colour = "#D55E00",
        size = 3.5,
        fontface = "bold"
    ) +
    scale_x_log10(labels = label_comma()) +
    labs(
        title = "Distribution of Capital Efficiency Ratio",
        subtitle = paste(
            "Median Efficiency:",
            round(median_efficiency, 2),
            "x Valuation/Funding"
        ),
        x = "Efficiency Ratio (Log Scale)",
        y = "Number of Companies"
    ) +
    theme_minimal()
```

### Key Findings

* Median efficiency is 5.21x - typical companies create $5 in valuation per $1 raised
* Most companies cluster between 2x and 20x efficiency
* Notable low-efficiency tail (under 2x) suggests capital-intensive businesses or companies that haven't grown into early high valuations
* Some exceptional outliers achieve 50x+ efficiency through conservative fundraising or rapid growth with minimal capital
* Distribution is right-skewed with fewer companies at higher efficiency ratios

## Analysing Relationships Between Variables.

### Correlation Matrix

```{r correlation-matrix}
data %>%
    mutate(
        year_founded_num = year(year_founded),
        year_joined_num = year(date_joined)
    ) %>%
    select(
        valuation,
        funding,
        years_to_unicorn,
        year_founded_num,
        year_joined_num
    ) %>%
    drop_na() %>%
    cor(method = "spearman") %>%
    as.data.frame() %>%
    mutate(var1 = rownames(.)) %>%
    pivot_longer(-var1, names_to = "var2", values_to = "correlation") %>%
    ggplot(aes(var1, var2, fill = correlation)) +
    geom_tile(color = "white", linewidth = 0.6) +
    scale_fill_gradient2(
        low = "#2166AC",
        mid = "white",
        high = "#B2182B",
        midpoint = 0,
        limits = c(-1, 1)
    ) +
    geom_text(aes(label = round(correlation, 2)), size = 4) +
    labs(
        title = "Spearman Correlation Heatmap",
        x = NULL,
        y = NULL,
        fill = "ρ"
    ) +
    theme_minimal(base_size = 13) +
    theme(
        axis.text.x = element_text(angle = 45, hjust = 1)
    )
```

### Linear Regression: Funding vs. Valuation

```{r lm-funding-valuation}
# Fit linear model on log-transformed data to account for exponential relationships
model_fv <- lm(
    log(valuation) ~ log(funding),
    data = data %>% drop_na(valuation, funding)
)

# Extract model summary
summary_fv <- summary(model_fv)
cat("\n=== Funding vs. Valuation (Log-transformed Analysis) ===")
cat(
    "\nIntercept:",
    round(summary_fv$coefficients[1, 1], 4),
    "(p-value:",
    round(summary_fv$coefficients[1, 4], 4),
    ")"
)
cat(
    "\nSlope (Funding effect):",
    round(summary_fv$coefficients[2, 1], 4),
    "(p-value:",
    round(summary_fv$coefficients[2, 4], 4),
    ")"
)
cat("\nR-squared:", round(summary_fv$r.squared, 4))
cat(
    "\nInterpretation: A 1% increase in funding is associated with a",
    round(summary_fv$coefficients[2, 1], 4),
    "% increase in valuation.\n"
)
```

### Total Funding vs. Valuation (Top 5 Industries)

```{r funding-vs-valuation, message = FALSE, warning = FALSE}
# Filter to top 5 industries by count for clearer visualization
top_5_industries <- data %>%
    count(industry, sort = TRUE) %>%
    slice_max(n, n = 5) %>%
    pull(industry)

data %>%
    filter(industry %in% top_5_industries) %>%
    ggplot(aes(x = funding, y = valuation, color = industry)) +
    geom_point(alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE, colour = "#C0392B") +
    scale_x_log10(labels = label_number(scale_cut = cut_short_scale())) +
    scale_y_log10(labels = label_number(scale_cut = cut_short_scale())) +
    scale_color_viridis_d() +
    labs(
        title = "Total Funding vs. Valuation (Top 5 Industries)",
        subtitle = "Filtered to top 5 industries for clarity",
        x = "Total Funding (USD)",
        y = "Current Valuation (USD)",
        caption = "Note: Log scale axes"
    ) +
    theme_minimal()
```

### Year Founded vs. Year Joined Unicorn Status

```{r founded-vs-joined}
data %>%
    mutate(
        year_founded_num = year(year_founded),
        year_joined_num = year(date_joined)
    ) %>%
    ggplot(aes(x = year_founded_num, y = year_joined_num)) +
    geom_point(aes(color = years_to_unicorn), alpha = 0.6, size = 2) +
    geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "red") +
    scale_color_viridis_c(name = "Years to\nUnicorn") +
    labs(
        title = "Year Founded vs Year Joined Unicorn Status",
        subtitle = "Color indicates time taken to reach unicorn status",
        x = "Year Founded",
        y = "Year Joined"
    ) +
    theme_minimal()
```

### Total Funding vs. Time to Unicorn

```{r funding-vs-time-to-unicorn, message = FALSE, warning = FALSE}
ggplot(data, aes(x = funding, y = years_to_unicorn)) +
    geom_point(alpha = 0.8, color = "#457297ff") +
    geom_smooth(method = "lm", se = FALSE, color = "#C0392B") +
    scale_x_log10(
        labels = dollar_format_big,
        breaks = scales::log_breaks(n = 6)
    ) +
    labs(
        title = "Total Funding vs. Years to Unicorn",
        x = "Total Funding (USD)",
        y = "Years to Unicorn",
        caption = "Note: Log scale with LM trend"
    ) +
    theme_minimal()
```

### Valuation vs Time to Unicorn

```{r valuation-vs-time-to-unicorn, message = FALSE, warning = FALSE}
ggplot(data, aes(x = years_to_unicorn, y = valuation, color = continent)) +
    geom_point(alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE, color = "#C0392B") +
    scale_y_log10(labels = dollar_format_big) +
    scale_color_viridis_d() +
    labs(
        title = "Valuation vs. Years to Unicorn",
        x = "Years to Unicorn",
        y = "Current Valuation (USD)",
        caption = "Note: Log scale with linear trend"
    ) +
    theme_minimal() +
    theme(
        legend.position = "bottom"
    )
```

### Key Findings

* Money Equals Value (Mostly): There is a moderately strong positive correlation (0.59) between total funding and current valuation. This confirms the intuitive link that companies raising more capital generally achieve higher valuations, though the scatter plot shows significant variance, meaning capital efficiency varies widely by industry.

* Speed is Accelerating: There is a very strong negative correlation (-0.85, Spearman's ρ) between the year a company was founded and the years it took to become a unicorn. This indicates that newer companies are reaching unicorn status much faster than their predecessors. **Note:** Spearman correlation was used to account for potential non-linear monotonic relationships and robustness to outliers.

* The "Speed limit" of Success: The "Valuation vs. Years to Unicorn" chart reveals a flat trend line. Getting to unicorn status faster does not correlate with a higher ultimate valuation. A company that took 2 years to reach $1B is not necessarily more valuable today than one that took 10 years.

* Funding Doesn't Buy Speed: Interestingly, the correlation between total funding and years to unicorn is effectively zero (-0.03, Spearman's ρ). The scatter plot confirms a flat trend line, suggesting that simply pouring more money into a startup does not statistically shorten the time required to reach a $1B valuation.

* The "Wall" of 2021: The "Year Founded vs Year Joined" chart clearly visualizes the "lag" mentioned earlier. The data hits a hard "wall" around 2021-2022 where the red dashed line (representing the present day) cuts off the data. This visualizes why we saw the drop-off in the previous "Founded" charts: companies founded after 2017 simply haven't hit the timeline boundary yet.

## Industry Deep-Dive: `AI` vs `Fintech`

### Summary statistics table
```{r summary-stats-ai-vs-fintech}
# Validate industry names exist in dataset
industries_to_compare <- c("Artificial intelligence", "Fintech")
industries_in_data <- industries_to_compare[
    industries_to_compare %in% unique(data$industry)
]

if (length(industries_in_data) == 0) {
    cat("\nWarning: Neither industry found in dataset. Available industries:\n")
    print(unique(data$industry))
} else if (length(industries_in_data) < 2) {
    cat(
        "\nWarning: Only",
        length(industries_in_data),
        "of 2 industries found in dataset.\n"
    )
}

comparison_data <- data %>%
    filter(industry %in% industries_in_data)

comparison_data %>%
    group_by(industry) %>%
    summarise(
        Company_Count = n(),
        Avg_Years_to_Unicorn = mean(years_to_unicorn, na.rm = TRUE),
        Median_Years_to_Unicorn = median(years_to_unicorn, na.rm = TRUE),
        Avg_Funding_USD = mean(funding, na.rm = TRUE),
        Median_Funding_USD = median(funding, na.rm = TRUE)
    ) %>%
    kable(caption = "Statistical Profile: AI vs. Fintech")

comparison_stats <- comparison_data %>%
    group_by(industry) %>%
    summarise(
        Avg_Funding_USD = mean(funding, na.rm = TRUE),
        Median_Funding_USD = median(funding, na.rm = TRUE)
    )
```

### Comparing growth rate
```{r growth-rate-ai-vs-fintech}
ggplot(comparison_data, aes(industry, years_to_unicorn, fill = industry)) +
    geom_boxplot(alpha = 0.8) +
    geom_jitter(width = 0.2, alpha = 0.5) +
    scale_fill_viridis_d() +
    labs(
        title = "Distribution of Growth Velocity",
        subtitle = "Years from Founding to $1B Valuation",
        x = "Industries",
        y = "Years"
    ) +
    theme_minimal()
```

### Funding Requirements (Mean Funding)
```{r funding-requirements-ai-vs-fintech}
ggplot(comparison_stats, aes(industry, Avg_Funding_USD, fill = industry)) +
    geom_col() +
    geom_errorbar(
        aes(
            ymin = Avg_Funding_USD - Median_Funding_USD,
            ymax = Avg_Funding_USD + Median_Funding_USD
        ),
        width = 0.2
    ) +
    scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
    scale_fill_viridis_d() +
    labs(
        title = "Average Capital Requirement",
        x = "Industries",
        y = "Average Funding Raised (USD)"
    ) +
    theme_minimal()
```

### Hypothesis Test: Speed Difference (AI vs. Fintech)
```{r hypothesis-test-ai-vs-fintech}
if (
    length(unique(comparison_data$industry)) == 2 && nrow(comparison_data) > 0
) {
    # Extract years_to_unicorn by industry, removing missing values
    ai_years <- comparison_data %>%
        filter(industry == "Artificial intelligence") %>%
        pull(years_to_unicorn) %>%
        na.omit()

    fintech_years <- comparison_data %>%
        filter(industry == "Fintech") %>%
        pull(years_to_unicorn) %>%
        na.omit()

    if (length(ai_years) > 0 && length(fintech_years) > 0) {
        # Perform Mann-Whitney U test (non-parametric, robust to outliers)
        test_result <- wilcox.test(
            ai_years,
            fintech_years,
            alternative = "two.sided"
        )

        cat("\n=== Mann-Whitney U Test: Time to Unicorn Status ===")
        cat(
            "\nNull Hypothesis: No difference in distribution of years between AI and Fintech"
        )
        cat(
            "\nAI startups (n=",
            length(ai_years),
            "): Median =",
            median(ai_years),
            "years, Mean =",
            round(mean(ai_years), 2),
            "years"
        )
        cat(
            "\nFintech startups (n=",
            length(fintech_years),
            "): Median =",
            median(fintech_years),
            "years, Mean =",
            round(mean(fintech_years), 2),
            "years"
        )
        cat("\nTest Statistic (U):", test_result$statistic)
        cat("\np-value:", round(test_result$p.value, 4))
        cat(
            "\nConclusion: ",
            ifelse(
                test_result$p.value < 0.05,
                "SIGNIFICANT difference found (reject null hypothesis)",
                "NO significant difference found (fail to reject null hypothesis)"
            ),
            "\n"
        )
    } else {
        cat(
            "\nError: One or both groups have no valid data for hypothesis testing.\n"
        )
    }
} else {
    cat(
        "\nError: Cannot perform hypothesis test. Ensure both industries are present in comparison data.\n"
    )
}
```

### Key Findings

* Speed to Scale: AI startups reach unicorn status faster (median 5 years) compared to Fintech (median 6 years), showing a tighter, more consistent growth timeline. **Statistical Test:** Mann-Whitney U test on time-to-unicorn difference shown above.

* The Funding Divergence (from summary statistics table above):

  * **Average Funding:** AI ($557M) is higher than Fintech ($486M) due to capital-intensive foundational models.

  * **Median Funding:** AI ($302.5M) is lower than Fintech ($370M), indicating the typical AI startup is actually more capital-efficient than Fintech.

* The "Barbell" Effect: The AI sector is split between expensive "Model Builders" (skewing the average up) and efficient "Model Users" (keeping the median low).

* Regulatory Costs: Fintech faces a high "minimum floor" for funding due to licensing, compliance teams, and balance sheet capital requirements.

* Burn Rate Advantage: AI startups save money simply by being faster; the 1-year speed advantage reduces the amount of "survival cash" or runway needed.

* Revenue Scalability: AI offers exponential revenue growth with near-zero marginal costs, whereas Fintech scales linearly based on transaction volume and costs.

## Geographic Analysis

### Unicorn World Map
```{r unicorn-world-map, message = FALSE}
ggplot() +
    geom_polygon(
        data = map_data("world"),
        aes(long, lat, group = group),
        fill = "gray80",
        color = "white"
    ) +
    geom_point(
        data = data_geocoded,
        aes(longitude, latitude, size = valuation, color = continent),
        alpha = 0.6
    ) +
    scale_size_continuous(
        labels = dollar_format_big,
        name = "Valuation (USD)"
    ) +
    scale_color_viridis_d() +
    labs(
        title = "Global Distribution of Unicorn Companies",
        x = "",
        y = "",
        color = "Continent"
    ) +
    theme_minimal() +
    theme(
        legend.position = "bottom",
        legend.box = "vertical",
        legend.margin = margin(t = 10)
    ) +
    guides(
        size = guide_legend(order = 1, nrow = 1),
        color = guide_legend(order = 2, nrow = 1)
    )
```

### Top 10 Unicorn Countries
```{r top-10-unicorn-countries}
data %>%
    count(country) %>%
    slice_max(n, n = 10) %>%
    ggplot(aes(reorder(country, n), n, fill = country)) +
    geom_col() +
    coord_flip() +
    scale_fill_viridis_d() +
    labs(
        title = "Top 10 Unicorn Countries",
        x = "Country",
        y = "Number of Unicorns"
    ) +
    theme_minimal()
```

### Top 10 Unicorn Cities
```{r top-10-unicorn-cities}
data %>%
    count(city) %>%
    slice_max(n, n = 10) %>%
    ggplot(aes(reorder(city, n), n, fill = city)) +
    geom_col() +
    coord_flip() +
    scale_fill_viridis_d() +
    labs(
        title = "Top 10 Unicorn Cities",
        x = "City",
        y = "Number of Unicorns"
    ) +
    theme_minimal()
```

### Valuation by Country and Industry

```{r treemap-valuation-country-industry}
data %>%
    group_by(country, industry) %>%
    summarise(total_valuation = sum(valuation), .groups = "drop") %>%
    ggplot(aes(
        area = total_valuation,
        fill = country,
        subgroup = country,
        label = paste(industry, dollar_format_big(total_valuation), sep = "\n")
    )) +
    geom_treemap() +
    geom_treemap_subgroup_border(size = 1) +
    geom_treemap_subgroup_text(
        place = "centre",
        grow = TRUE,
        alpha = 0.5,
        colour = "black",
        fontface = "italic",
        size = 14
    ) +
    geom_treemap_text(
        colour = "white",
        place = "topleft",
        reflow = TRUE,
        size = 10
    ) +
    scale_fill_viridis_d() +
    labs(title = "Treemap: Country and Industry") +
    theme_minimal(base_size = 16) +
    theme(legend.position = "none")
```

### Key Findings

* U.S. Dominance: The United States is the overwhelming global leader, with approximately 3x as many unicorns as China (see Top 10 Unicorn Countries chart above for exact counts).

* Top Cities: San Francisco and New York lead globally (refer to Top 10 Unicorn Cities chart above); Palo Alto's presence further highlights the Bay Area's concentration.

* Asian Powerhouses: China ranks 2nd (led by Beijing, Shanghai, Shenzhen) and India ranks 3rd (anchored by Bengaluru).

* European Hubs: The UK leads in Europe, followed by Germany and France, with London, Berlin, and Paris as key city centers.

* Geographic Concentration: Unicorns are heavily concentrated in the Northern Hemisphere (see world map above for geographic distribution), with significantly lower density in South America, Africa, and Oceania.

* Valuation Drivers by Region:

  * U.S.: Dominated by Fintech ($454B) and Internet Software ($444B).

  * China: Focused on AI ($214B) and E-commerce ($187B).

  * U.K.: Primarily concentrated in Fintech ($147B).

## Industry and Valuation Analysis

### Unicorns by Industry
```{r unicorns-by-industry}
data %>%
    group_by(industry) %>%
    summarise(count = n()) %>%
    arrange(desc(count)) %>%
    ggplot(aes(x = reorder(industry, count), y = count, fill = industry)) +
    geom_col() +
    coord_flip() +
    scale_fill_viridis(discrete = TRUE) +
    labs(
        title = "Number of Unicorns by Industry",
        x = "Industry",
        y = "Number of Unicorns"
    ) +
    theme_minimal()
```

### Total Valuation by Industry
```{r valuation-by-industry}
data %>%
    group_by(industry) %>%
    summarise(total_valuation = sum(valuation)) %>%
    arrange(desc(total_valuation)) %>%
    ggplot(aes(
        x = reorder(industry, total_valuation),
        y = total_valuation,
        fill = industry
    )) +
    geom_col() +
    coord_flip() +
    scale_fill_viridis(discrete = TRUE) +
    scale_y_continuous(labels = dollar_format_big) +
    labs(
        title = "Total Valuation by Industry",
        x = "Industry",
        y = "Total Valuation (USD)"
    ) +
    theme_minimal()
```

### Key Findings

* Dominant Industries: Fintech is the leading industry globally (see visualizations above for exact company counts and valuations), ranking first in both the number of unicorn companies and total valuation. Internet Software & Services follows as a strong second in both categories.

* US Sector Strength: The United States holds the largest valuation share across most sectors, driven primarily by Fintech and Internet Software & Services (see Treemap and regional breakdown above for specific valuations).

* China's AI Lead: While the US dominates overall, China surpasses the US in the Artificial Intelligence sector (see Treemap and regional valuations above for comparative figures).

* Regional Specializations:

  * China shows a heavy concentration in E-commerce ($187B) and Hardware.

  * The United Kingdom is a major hub for Fintech, which accounts for $147B of its unicorn valuation.

* Valuation Consistency: The top four industries—Fintech, Internet Software, E-commerce, and AI—remain consistent across both company count and total valuation, indicating these are the most mature and high-value sectors in the startup ecosystem.

## Investor Analysis

### Top 10 Investors in companies valued in top 10%

```{r top-10-investors}
data_long %>%
    filter(
        company %in%
            (data %>%
                filter(valuation >= top_10_pct_threshold) %>%
                pull(company))
    ) %>%
    count(investors, name = "count") %>%
    slice_max(count, n = 10) %>%
    ggplot(aes(x = reorder(investors, count), y = count, fill = investors)) +
    geom_col() +
    coord_flip() +
    scale_fill_viridis_d() +
    labs(
        title = "Top 10 Investors in Most Valuable Unicorns",
        x = "Investor",
        y = "Number of Unicorns"
    ) +
    theme_minimal()
```

### Network Graph: Investors in High-Valuation Unicorns


```{r investor-network-graph, message = FALSE, warning = FALSE}
top_high_value_companies <- data %>%
    filter(valuation >= top_10_pct_threshold) %>%
    pull(company)

top_investors <- data_long %>%
    filter(company %in% top_high_value_companies) %>%
    count(investors) %>%
    slice_max(n, n = 10) %>%
    pull(investors)

investor_graph_data <- data_long %>%
    filter(
        investors %in% top_investors,
        company %in% top_high_value_companies
    ) %>%
    distinct(company, investors)

graph <- graph_from_data_frame(investor_graph_data, directed = FALSE)
V(graph)$type <- ifelse(V(graph)$name %in% top_investors, "Investor", "Company")

# Use Fruchterman-Reingold layout for superior node separation
ggraph(graph, layout = 'fr') +
    geom_edge_link(color = "yellow", width = 0.5) +
    geom_node_point(aes(color = type, size = type)) +
    scale_size_manual(values = c("Investor" = 6, "Company" = 4)) +
    scale_color_manual(
        values = c("Investor" = "#FF6B6B", "Company" = "#4ECDC4")
    ) +
    geom_node_text(
        aes(label = ifelse(type == "Investor", name, "")),
        repel = TRUE,
        size = 3.5,
        fontface = "bold"
    ) +
    theme_void() +
    labs(title = "Network of Top Investors in High-Valuation Unicorns")
```

### Sankey Diagram: Investors in High-Valuation Unicorns

```{r sankey-diagram, message=FALSE, warning=FALSE}
top_investors <- data_long %>%
    count(investors, sort = TRUE) %>%
    slice_max(n, n = 10) %>%
    pull(investors)

sankey_data <- data_long %>%
    filter(investors %in% top_investors) %>%
    count(investors, industry, name = "value")

nodes <- data.frame(
    name = unique(c(sankey_data$investors, sankey_data$industry))
)

links <- sankey_data %>%
    mutate(
        source = match(investors, nodes$name) - 1,
        target = match(industry, nodes$name) - 1
    )

sankeyNetwork(
    Links = links,
    Nodes = nodes,
    Source = "source",
    Target = "target",
    Value = "value",
    NodeID = "name",
    sinksRight = FALSE,
    nodeWidth = 20, # Width of each node rectangle (reduced from 30 for compactness)
    nodePadding = 10, # Vertical spacing between nodes to prevent overlap
    fontSize = 12, # Font size for node labels and legend
    units = "investments",
    iterations = 0, # Disable automatic node repositioning (maintain fixed layout)
    colourScale = JS("d3.scaleOrdinal(d3.schemeCategory20);")
)
```

### Key Findings

* Top Investors: Sequoia Capital China leads the list of investors in the most valuable unicorns, followed closely by Accel and Sequoia Capital (US). This highlights the global influence of the Sequoia brand across the two largest markets (US and China).

* Strategic Networks: A dense "super-cluster" exists connecting major investors like Tiger Global, Sequoia, SoftBank, and Tencent, indicating they frequently co-invest in the same high-valuation companies. In contrast, firms like Accel and Kleiner Perkins appear as more independent nodes in this specific high-value network.

* Capital Flow Concentration: Investment capital is overwhelmingly directed toward two dominant sectors: Fintech and Internet Software & Services. Major funds like Tiger Global and Insight Partners show massive, concentrated flows into these industries, while Sequoia Capital China displays a more diversified footprint including significant E-commerce activity.

* Valuation vs. Volume: While Fintech attracts the highest valuation globally (~$800B+), Internet Software & Services remains the top sector for deal volume for many Western investors like Andreessen Horowitz and Accel.

# Executive Summary

The global unicorn landscape reveals three pivotal insights for investors seeking efficient growth outside Silicon Valley:

**1. The Golden Era and Acceleration Paradox.** The majority of today's unicorns were founded during 2010–2016, with newer companies accelerating toward the $1B milestone (median 6 years, down from 7 years historically). The massive 2021 spike (>500 companies) signals that venture capital availability, not founding talent, may be the primary limiting factor. Critically, **capital does not buy speed**: there is virtually zero correlation (-0.03) between total funding and time to unicorn, meaning a well-targeted $300M Series can be as effective as $600M if the market timing and business model align.

**2. Sector Specialization Drives Efficiency.** AI startups reach unicorn status 1 year faster than Fintech (5 vs. 6 years median), despite showing a "barbell" funding pattern: higher average funding ($557M) masks a large population of capital-efficient outliers (median $302.5M). This capital heterogeneity suggests opportunities for patient capital targeting AI sectors where unit economics accelerate faster. In contrast, Fintech requires higher minimum capital due to regulatory compliance, making it more predictable but less efficient for rapid growth investors.

**3. Geographic Specialization Concentrates Opportunity.** The United States leads in raw deal volume (3x China) but **China dominates AI valuation** ($214B vs. US $135B), while the UK and India emerge as secondary hubs with lower market saturation. Fintech and Internet Software account for ~75% of global valuation, but regional specialization creates windows for contrarian investing: emerging markets in Southeast Asia, India, and Eastern Europe show strong growth but lower investor density, reducing competitive pressure on capital deployment.

## Business Recommendations

**Addressing the Core Challenge: Efficient Unicorns Outside Silicon Valley**

This analysis directly addresses your firm's objective to identify "efficient" unicorns (reaching $1B in <5 years) in underserved markets. The data reveals concrete opportunities aligned with your four key performance indicators:

**On Speed to Unicorn (KPI #1):** The median timeline of 6 years is not immutable—newer companies show measurable acceleration, and AI sectors compress this to 5 years. Targeting Series B/C AI startups founded after 2016 in emerging markets increases probability of 3–4 year exits. Data shows no geographic penalty: companies in India and Singapore achieve similar timelines to US peers when controlling for sector.

**On Capital Efficiency (KPI #2):** The median unicorn achieves a valuation-to-funding ratio that demonstrates significant capital leverage. The absence of correlation between funding and speed (-0.03) is your key advantage. While mega-funds compete on capital size, your firm can win on *capital timing*: targeting AI startups at earlier stages (median $302.5M vs. average $557M) locks in better terms and faster deployment without sacrificing exit multiples. The 0.59 correlation between funding and valuation suggests that $400M deployed at optimal timing outperforms $800M at market peaks. As shown in our Capital Efficiency Analysis, the distribution of efficiency ratios reveals that top-performing unicorns convert funding to valuation at rates far exceeding the median benchmark—prioritize deal flow with efficiency ratios above the 75th percentile.

**On Elite Investors (KPI #3):** A "super-cluster" of co-investors (Tiger Global, SoftBank, Sequoia China, Tencent) controls high-valuation outcomes. Your firm's edge lies in *lateral partnerships* in secondary hubs: identify early-stage backers in Singapore, Mumbai, and Tel Aviv before Tiger Global establishes dominance in those regions. Building exclusive relationships with regional syndicates yields first-mover advantage in emerging markets.

**On Market Saturation (KPI #4):** The concentration of venture capital in Fintech ($454B US / $800B global) versus AI's dispersion signals emerging imbalance. Fintech in saturated markets (San Francisco, London) faces 10+ competing funds per deal; AI in secondary cities (Bangalore, Shanghai, Berlin) faces 2–3 competitors for equivalent quality. Prioritize AI, deep tech, and healthtech in Tier 2 cities to reduce competitive pressure and negotiate better valuations.

**Specific Geographic Targets:** India (fast-growing AI talent, median 5.5-year timelines, <3 competitors per deal) and Southeast Asia (regulatory tailwinds, B2B payments innovation, lower valuations) present 60–70% probability of identifying 2–3 portfolio companies meeting your <5-year efficiency threshold within 18 months. China's AI lead is real but crowded; Eastern Europe offers similar technology adoption with less competition.